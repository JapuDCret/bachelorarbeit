% \chapter{Beispielhafte Integration}
	
\section{Anforderungen}
\input{content/04_erstellung-poc/anforderungen}
	
\section{Vorstellung der Demoanwendung}
\input{content/04_erstellung-poc/vorstellung-demoanwendung}
	
% \newpage
	
\section{Konzept}
	
	\subsection{Datenverarbeitung}

	Auf Basis der zuvor vorgestellten Methoden und Praktiken wird nun eine sinnvolle Kombination für das Frontend konzeptioniert, die als Ziel hat, die Nachvollziehbarkeit nachhaltig zu erhöhen. Es werden die Grunddisziplinen Datenerhebung, -auswertung und -präsentation unterschieden und nacheinander beschrieben. Danach und darauf aufbauend wird eine grobe Architektur vorgestellt, die diese Ansätze in ein Gesamtbild bringt.
		
	\subsubsection{Erhebung}
	
	Wie zuvor in \autoref{sec:nachvollziehbarkeit-bei-spas} beschrieben, erhalten Betreiber und Entwickler im Normalfall nur unzureichende Information über das Anwendungsverhalten oder die getätigten Nutzerinteraktionen bei einer SPA. Aus diesem Grund sollen explizit weitere Daten erhoben werden, um die Nachvollziehbarkeit zu erhöhen.
	
	Wie aus den Erkenntnissen von FAME (\autoref{sec:fame}) und Kaiju (\autoref{sec:kaiju}) zu deuten ist, gibt es durch die Verknüpfung von verschiedenen Datenkategorien einen Mehrwert für die Verständnis von Betreibern und Entwicklern. Deshalb sollen in der Lösung die 4 Datenkategorien \enquote{Logs}, \enquote{Metriken}, \enquote{Traces} und \enquote{Fehler} erhoben und an Partnersysteme weitergeleitet werden.
	
	Neben diesen Daten sollen auch die Benutzerinteraktionen aufgezeichnet werden. Hierfür soll jedoch kein tiefer gehendes Real-User-Monitoring zur Verwendung kommen, stattdessen soll ein Session-Replay-Mechanismus eingesetzt werden. RUM wird nicht gefordert, da es für die Verständnisgewinnung der Benutzerinteraktionen weniger aussagekräftig ist als Session-Replay. Bei Session-Replay werden die Benutzerinteraktionen im Kontext dargestellt und nicht gesondert oder abstrahiert, was für eine Nachvollziehbarkeit hinderlich sein kann. Beim Session-Replay wird jedoch jedwede Ein- und Ausgaben der Webanwendung aufgezeichnet, damit dies nicht ein zu großes Datenvolumen erzeugt und um den Nutzer nicht konstant zu überwachen, sollte sie standardmäßig abgeschaltet sein und nur auf expliziten Nutzerwunsch aktiviert werden.
	
	\vspace{-0.75\baselineskip}
	\subsubsection{Auswertung}
	\vspace{-0.50\baselineskip}
	
	Die genaue Auswertung ist Teil der Implementierung und diese Disziplin sieht keine direkten Vorgaben vor. Jedoch sind die gemeldeten Daten mit Kontextinformationen anzureichern, wenn möglich. Diese umfassen bspw. Zeitstempel, User-Agent, IP, Browser.
	
	\vspace{-0.75\baselineskip}
	\subsubsection{Präsentation}
	\vspace{-0.50\baselineskip}
	
	Um ein zufriedenstellendes Ergebnis zu gewährleisten, sollte die Lösung die Daten auf folgende Weise den Betreibern und Entwicklern präsentieren:
	
	\begin{enumerate}
		\item Logdaten..
		\begin{enumerate}
			\item ..lassen sich einsehen.
			\item ..lassen sich basierend auf ihren Eigenschaften filtern.
		\end{enumerate}
		\item Fehler..
		\begin{enumerate}
			\item ..lassen sich einsehen,
			\item ..lassen sich basierend auf ihren Eigenschaften filtern,
			\item ..lassen sich gruppieren.
			\item Fehlergruppen lassen sich in Graphen visualisieren (bspw. Histogramm der Häufigkeit).
		\end{enumerate}
		\item Metriken..
		\begin{enumerate}
			\item ..lassen sich in Graphen visualisieren.
		\end{enumerate}
		\item Traces..
		\begin{enumerate}
			\item ..lassen sich einsehen,
			\item ..lassen sich basierend auf ihren Eigenschaften filtern,
			\item ..lassen sich als ein Trace-Gantt-Diagramm darstellen.
		\end{enumerate}
		\item Session-Replay-Daten
		\begin{enumerate}
			\item Mithilfe der Session-Replay-Daten soll eine videoähnliche Nachstellung einer Sitzung erstellt werden.
		\end{enumerate}
	\end{enumerate}
	
	\subsection{Architektur}
	
	Auf Basis der zuvor beschriebenen Grunddisziplinen wird nun eine beispielhafte Umsetzung dessen konzipiert. Genauer wird eine Architektur vorgeschlagen, welche auf die zuvor betrachteten Methoden und Praktiken zurückgreift, um eine verbesserter Nachvollziehbarkeit zu erreichen. Speziell wird im Folgeabschnitt zudem vorgeschlagen, welche Werkzeuge oder Technologien zum Einsatz kommen sollen und wie diese Komponenten miteinander kommunizieren.
	
	 Die genaue Erhebung der Daten ist Teil der Implementierung und wird hier nicht näher bestimmt. Jedoch ergeben sich aus der zuvor definierten Anforderungen zur Erhebung bereits Datenkategorien, welche von einem entsprechenden Partnersystem zu konsumieren und verarbeiten sind. Es wird zwar nicht auf spezielle Werkzeuge oder Technologien eingegangen, aber es lassen sich bereits Partnersysteme bestimmen, auf Basis der zuvor identifizierten Funktionsbereiche. Hierbei wurde zudem versucht möglichst viele Bereiche über die gleichen Partnersysteme abzubilden (vgl. \autoref{anf:3100}), die Machbarkeit einer solchen Verknüpfung basiert auf den Ergebnissen von \autoref{chap:methoden-und-praktiken}.
	 
	 So soll für die Verarbeitung von Fehler-, Log-, und Metrikdaten ein einzelnes Partnersystem verantwortlich sein, welches ermöglicht diese zu konsumieren, speichern, durchsuchen und diese zu visualisieren. Grund hierfür ist, dass die Daten gemeinsame Eigenschaften besitzen, die eine gemeinsame Verarbeitung erlauben. In der \autoref{fig:grobe-architektur} ist dieses System als \enquote{Log- und Monitoringplattform} vorzufinden.
	
	Um Traces zu konsumieren und den Betreibern und Entwicklern aufbereitet zu visualisieren, soll ein weiteres Partnersystem eingesetzt werden. Dieses System wurde als notwendig empfunden, da kein Werkzeug identifiziert werden konnte, welches neben Traces noch andere Datenkategorien zufriedenstellend abdecken kann. Auf Basis von OpenTelemetry könnten sich jedoch in Zukunft Technologien entwickeln, welches alle 3 Datenkategorien von OpenTelemetry unterstützt: Metriken, Traces und Logs. Es wurde sich zudem gegen eine weitreichende Monitoringplattform, wie z. B. New Relic oder Dynatrace, entschieden, denn hier wurde identifiziert, dass diese nicht ausreichend flexibel für verschiedene Projekte sind und zudem auch nicht erlauben, dass einzelne Komponenten ausgetauscht oder entfernt werden können.
	
	Es ist zudem ein drittes System notwendig, um die gewünschte Funktionalität des Session-Replays einzubinden. Session-Replay ist ein spezielles und sehr konkretes Aufgabengebiet und es konnte kein Werkzeug identifiziert werden, welches sich nicht nur auf dieses Gebiet spezialisiert.
	
\begin{figure}[H]
	\centering
	\includegraphics[width=1.00\linewidth]{img/04_erstellung-poc/konzept-simple.png}
	\caption{Grobe Architektur}
	\label{fig:grobe-architektur}
\end{figure}

%Wie in der Datenerfassung erwähnt, werden die einzelnen Datentypen unterschiedlich erhoben und besitzen somit auch andere Eigenschaften. Wie bei Big Data \cite{ZikopoulosUnderstandingBigData}, lassen sich auch hier die Eigenschaften Volume, Velocity und Variety identifizieren. Der Aspekt Volume ist weniger präsent, denn die Datenmengen sind nicht vergleichbar mit echten Big-Data-Anwendungen. Genau ist dies nicht prognostizierbar, aber in der Evaluierung des Stands der Technik, ließ sich ein Datendurchsatz von 1 MB/min feststellen - somit stellt dies im Frontend keine Herausforderung dar, jedoch in den verarbeitenden Systemen kann dies natürlich durch eine große Menge an Frontends multipliziert werden, was jedoch nicht im Fokus der Arbeit steht.
%
%Eine Variety der Daten, also Unterschiedlichkeit der Datenstruktur, ist definitiv vorhanden und entspringt den verschiedenen Funktionsgebieten. Auch innerhalb derselben Datenströme kann eine Variety identifiziert werden, denn bspw. sind Logmeldungen sehr individuell, sie folgen meist nicht streng einem Format und enthalten unterschiedliche Mengen an Informationen.
%
%Der Aspekt des Velocity ist zudem auch sehr wichtig und eine Visualisierung dessen für das vorhergehende Konzept findet sich in \autoref{fig:grobe-architektur-datendurchsatz}.
%	
%\begin{figure}[H]
%	\centering
%	\includegraphics[width=0.75\linewidth]{img/04_erstellung-poc/konzept-datendurchsatz.png}
%	\caption{Grobe Architektur mit hervorgehobenem Datendurchsatz}
%	\label{fig:grobe-architektur-datendurchsatz}
%\end{figure}

	\subsection{Technologie-Stack}
	\label{sec:technologie-stack}
	
	Auf Basis der zuvor erstellten Architektur wird sich nun für spezielle Technologien entschieden, mit der diese Architektur umgesetzt werden soll. Weiterhin wird behandelt, wie die Daten vom Frontend aus erhoben werden sollen und wie sie an die Partnersysteme gelangen.
	
	Für die \enquote{Log- und Monitoringplattform} wurde sich für Splunk entschieden, denn auf Basis der Evaluierung konnte festgestellt werden, dass Splunk die drei gewünschten Datenkategorien Logs, Metriken und Fehler zufriedenstellend unterstützt. Es wurde sich gegen New Relic und Dynatrace entschieden, da es diesen Werkzeugen an Flexibilität fehlt und sie viele Funktionen anbieten, die für die Lösung nicht notwendig sind. Eine weitere Alternative ist der Elastic Stack, welcher jedoch nicht näher evaluiert wurde. Somit wird Splunk eingesetzt, aber für eine äquivalente Lösung kann Splunk durch ein gleichwertiges Werkzeug ausgetauscht werden.
	
	Für das Partnersystem, welches sich mit den Tracedaten befasst, wurde sich für Jaeger entschieden. Die Entscheidung wurde auf der Basis getroffen, dass Jaeger einen moderner Tracingdienst darstellt, welcher zudem quelloffen entwickelt wird. Weiterhin ist in Zukunft eine Unterstützung des OpenTelemetry-Standards geplant, was durch die standardisierte Schnittstelle die Anbindung an bestehende Systeme vereinfachen wird. Des Weiteren erfüllt Jaeger alle aufgestellten Kriterien und erzeugt zudem ein Abbild der Systemarchitektur auf Basis der Traces.
	
	Um die Session-Replay-Funktionalität einzubringen wird in diesem Konzept LogRocket vorgeschlagen. LogRockets Nachstellung einer Sitzung ist nicht nur wie gefordert videoähnlich, sondern auch interaktiv. Die gesamte HTML-Struktur wird nachgestellt und kann so zu jedem Zeitpunkt begutachtet werden.
	
	Der sich daraus ergebende Technologiestack, angewandt auf die Architektur, ist in \autoref{fig:architektur-technologien} zu betrachten. Wie bei Splunk erwähnt sind auch die anderen Werkzeuge durch gleichwertige Werkzeuge ersetzbar, so können individuelle Anpassungen erfolgen und betriebliche Gegebenheiten zu berücksichtigen.
	
\begin{figure}[H]
	\centering
	\includegraphics[width=1.00\linewidth]{img/04_erstellung-poc/konzept-technologien.png}
	\caption{Architektur mit speziellen Technologien}
	\label{fig:architektur-technologien}
\end{figure}

	\subsection{Übertragbarkeit}
	
	Übertragbarkeit beschäftigt sich mit der Eigenschaft eines Ansatzes in verschiedene Situationen anwendbar zu sein. Ein Ansatz ist nicht übertragbar, wenn zu vielen Annahmen über die Situation getroffen werden.
	
	Das zuvor definierte Konzept wurde getrennt von der Demoanwendung erstellt und ist somit nicht auf dessen Eigenschaften beschränkt. Das Konzept nimmt dennoch an, dass es sich um eine Webanwendung handelt, auf das es anzuwenden ist. Weiterhin wird angenommen, dass Quellcodeänderungen vorgenommen werden können und das Partnersysteme hinzugefügt sowie angebunden werden können.
	
	Es wird jedoch nicht angenommen, dass die Partnersysteme exakt von den vorgeschlagenen Technologien realisiert werden. Vielmehr wurde die Funktionsgruppen definiert, zusammengefasst und darauf basierend eine Auswahl getroffen. Sowohl die Zusammenfassung der Funktionsgruppen als auch die Auswahl der eigentlichen Technologien sind individuell änderbar, sodass ein angepasstes aber äquivalent hilfreiches Konzept resultiert.
	
	Somit lässt sich abschließend betrachten, dass das Konzept eine akzeptable Übertragbarkeit aufweist. Eine tiefergehende Nachbetrachtung der Übertragbarkeit erfolgt in \autoref{sec:uebertragbarkeit}, im Anschluss an die Implementierung. Hierbei kann es zu Abweichungen zu dieser Bewertung der Übertragbarkeit kommen, aufgrund von Implementierungsdetails oder einem geänderten Vorgehen. Auf Basis des beleuchteten Konzeptes, wird im nächsten Abschnitt die eigentliche Umsetzung beschrieben.

\section{Implementierung}
\input{content/04_erstellung-poc/implementierung}

	\textit{Auf Basis des Konzeptes soll nun eine Implementierung erfolgen.}